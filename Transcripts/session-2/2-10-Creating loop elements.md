kịch bản video hướng dẫn từng bước — trình bày dạng video tutorial có thoại, từng bước rõ ràng, kết hợp phần hình ảnh minh họa , với nội dung sau: 
2-10-
Creating loop elements
Selecting transcript lines in this section will navigate to timestamp in the video
- [Instructor] Any Revit element that is created using a closed loop in sketch mode, such as floors and roofs, are done so using Revit types that contain collections of curves, such as curve loops and curve arrays in the API. So let's have a look at how to create a new floor in Revit using these types. In this file, I've gone ahead and created the place loop element class which is a new I-external command. This is based off the last exercise in which we used curves to create some walls. Let's now use these to create a new floor. In the object browser, go ahead and search for new floor. These are three different methods we can use to create a floor. You might be wondering why these aren't in the floor class. This is a bit of a quirk of the Revit API in which some creation methods are found in the Creation.Document namespace from when the first Revit API was released. Let's use this simple method that takes a curve array and a boolean to create a floor. A curve array is simply a Revit collection class that contains curves. It allows us to add curves into an overall list. But that's about it. Let's have a look at the curve loop class. This is another Revit collection type that acts like a list of curves. Unlike the curve array, the curve loop requires the curves to be ordered sequentially and let's us create them in different ways, such as offsetting. This method requires a curve loop to offset, a distance, and a plane normal to offset from. So let's use this method to create an offset curve loop from the wall center line so the floor is flush with the outside wall and then convert it to a curve array to create the floor. The first thing we need to do is create a curve loop using the curves from the last exercise and then create the offset curve loop. Let's start by constructing a curve loop variable called crvLoop. Then assign to this a new curve loop by accessing the static create method from the curve loop class. This takes a list of curves, which we currently have as curves. Next, let's offset this curve loop. To do that we need an offset distance. In the last exercise, we created walls using the default type. This appears to be basic wall, double brick 270. So let's hard code in an offset of 135 millimeters. The Revit API, however, works in feet, so we'll need to convert the number. To do this, we can use the unit utils class. First create a double variable named offset and assign to this a call to the convert to internal units from the unit utils class. Then use 135 as the first parameter and the second is the type of units. This is an enumeration. Call display unit type, which will be DUT millimeters. So this will convert our millimeter units to feet. We can now offset the curve loop, create another curve loop variable named offset curve, and let's assign to that a new curve loop by accessing the create via offset method from the curve loop class. And we'll supply the curve loop, the offset distance, which will be offset, and the normal. This will basically be up or a vector in the zed axis. In the Revit API, the x, y, zed object is also a vector. So let's create a new x, y, z with one for the zed parameter. Great, so we now have our offset curve loop. Let's now convert that to a curve array by creating a new curve array named cArray. Then to assign each curve from the curve loop, we can look through it like a list. So let's start a foreach loop, looping through each curve using the variable c in offset curves. And for each loop, let's use the append method to add the curve to the curve array. Perfect, we now have the ingredients to create a floor. Inside of the transaction, let's make a call to the new floor method from the document.creation class, using the curve array and false for non-structural. I've already gone ahead and put this into the manifest. So let's go ahead and give it a try. Hit debug and then let's open up the Revit exercise file for this video. And in the ground floor plan, let's go ahead and try the new command, place loop element. So there was no error so it appears it may have worked. Let's change to a 3D view. Perfect, there's our new floor. If you want to take this command a bit further, you could try filtering the view to find the walls already placed in the view to determine how much to offset the curve loop for rather than hard coding the amount. You can even automatically detect unit types from the unit object in the document.