kịch bản video hướng dẫn từng bước — trình bày dạng video tutorial có thoại, từng bước rõ ràng, kết hợp phần hình ảnh minh họa , với nội dung sau: 
2-11-
Get parameter
Selecting transcript lines in this section will navigate to timestamp in the video
- [Instructor] When working in Revit, we can adjust different parameters of an element to change different characteristics. Using the Revit API, we can do the same thing, accessing and editing an element's parameters directly from our commands. In this video, let's have a look at getting parameters. First, though, let's have a look at what parameters actually are. Parameters come in the form of parameter objects. Each object can be retrieved and set from an element with the API, as we can with the user interface. Each parameter object has a definition property that returns a definition object describing the parameter name and type. For instance, say a door had a parameter named Head Height. The definition will store its name, Head Height, and the type of unit it contains, length in this example. Each parameter also has a value, which is either an integer, double, string, element ID, or none. These values are what we actually see in the interface. All objects that we work with in Revit that inherit from the element class can have parameters associated with them. We can retrieve parameters in several different ways. Some of these are by accessing the Parameters method from an element. This will get all the parameters associated with an element. We can also use the GetOrderedParameters method. This means it'll get all the parameters that we can see associated with an element in the user interface. We can use the Parameter and LookupParameter method, which can be used to get a single element from an element by using a string or built-in parameter. And we can also use the GetParameters method. This is used to get all parameters of a single name, as elements can sometimes have more than one parameter with the same string name. This is because project parameters can be bound to an element category, even if an element has a built-in parameter of the same name. For example, say we had a project parameter, called Height, attached to the door category. Doors would therefore have more than one parameter named Height. One that is project set and one that is inherently built into the doors. The best way to deal with this is to use built-in parameters. In Visual Studio, I've currently got the exercise file open for this video. In this file I've gone ahead and created the GetParameters class, which is a new external command. We can use this to get parameters. This is similar to the GetElement ID command, in that it will allow us to select an element and then retrieve that element. The difference here, is I put the element retrieval inside of the if statement to make it a little bit safer. So let's use this to get the Head Height parameter of a window. And then we'll then display some of its information. To do that, let's start by creating a parameter variable named param. And then we'll assigned to this a call to the LookupParameter method from the element that's been retrieved. For the parameter, let's use the name of the parameter. In this case, it will be Head Height, making sure to capitalize both words, as this is case sensitive. Now we have the parameter from the element, we can start accessing its properties. Let's start by looking at the definition that stores information about the parameter type. This can be retrieved from the definition property of the parameter. And it can be either an internal or external definition. Every parameter has an internal definition, whereas they may not have an external parameter definition, which are those that are saved into a shared parameter file. So let's create an internal definition variable named paramDef. And we'll assign to this the definition property from the parameter, as internal definition, so we're casting it to an internal definition type. Now that we have the parameter and the internal definition, let's retrieve some of the information from them, such as its name, unit type, and built-in parameter enumeration. On a new line, let's create a task dialogue, and call the Show method, which will display some of the information. Let's call it Parameters for the title and, to show each of the values, let's use a string format. And the first argument, let's show the parameter name. The second argument, will be the parameter type. And the third, will be the built-in parameter. We can then access each of these properties from the definition. So paramDef.Name, paramDef.UnitType and paramDef.BuiltInParameter. A built-in parameter is an enumeration like a built-in category. All native parameters, that is non-user-defined parameters, have a built-in parameter associated with them. I've already gone ahead and added this command into the manifest. So let's give it a try by hitting the debug button. And then open up the Revit exercise file for this video. And let's go ahead and try our new command, GetParameter. Then select a window. Perfect. So you can see it's the Head Height parameter of type UT Length with a built-in parameter, Instance Head Height Param. And as we can see on the window, here's the parameter. Keep in mind here that if we use this command on a non-window, that is one that does not have this parameter, it may cause an error. This is something to keep in mind, when making your commands safe.