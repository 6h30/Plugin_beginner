kịch bản video hướng dẫn từng bước — trình bày dạng video tutorial có thoại, từng bước rõ ràng, kết hợp phần hình ảnh minh họa , với nội dung sau: 
4-3-
Tagging elements
- [Instructor] Now that we know how to create views and apply filters, let's have a look at the next step in developing views which is annotating elements. This is done in the API by using either the IndependentTag class or the RoomTag class. The IndependentTag class is used to create a tag object which can be done with one of two create methods, the first allows us to specify the tag type to use, and the second will use a default tag type, depending on the element that we're tagging. This will be different for doors and windows for example. This method tags quite a few different parameters, including the view to tag in, this can be either 2D or a locked 3D view, we'll also need the element to tag as a reference, a Boolean for whether or not to show the leader, a tag mode which is an enumeration. This can be used to decide whether to tag by category or by material for example, and then tag orientation. This is another enumeration which can be either vertical, or horizontal, and finally a point for the tag location. Using this method let's create a new command that tags all the windows and doors in an active view. I currently have the Visual Studio exercise file open for this video, in here I've gone ahead and created a TagView class which is a new IExternalCommand. Within the command I've retrieved the document, and I've started a transaction. We can use this to tag our elements, so let's start by collecting the parameters that we'll need to tag with the elements in our view. Let's start with the tag mode and orientation. For the tag mode, let's simply create a TagMode variable named tmode, and we'll assign to this the TagMode enumeration, and we want to tag by category. We could also use the material or multi-category if we like. To get the tag orientation let's create a TagOrientation variable named torient, and we'll assign to that the TagOrientation enumeration and Horizontal, easy. Now let's find the elements to tag. In this case we want the windows and doors. To do that we'll need to create a multi-category filter which we can apply to a filtered element collector. This filter requires a list of BuiltInCategories to filter, so let's start by creating a list of BuiltInCategories named cats. Now using this list, let's add the BuiltInCategory for windows and doors, this will be OST_Windows, and OST_Doors, now with this list we can create an element multi-category filter. So let's do this and we'll call it filter. This will be a new ElementCategoryFilter and for the parameter we can use our cats list meaning we'll filter for all of those categories and you can see I have an error because I've used the ElementCategoryFilter. We want ElementMulticategoryFilter. Perfect, using this we can now filter for those categories so let's create an Ilist of elements called tElements and we'll assign to this a new FilteredElemenentCollector for the parameters of this FilteredElemenetCollector we only want to collect from the active view. So this time let's choose the document, and then the active view in the document. So doc.ActiveView.Id, and now we can apply our filters. So let's add the WherePasses method. Then our filter, that we have created and to make this a little bit faster, let's remove elements that are element types, by using the whereElementIsNotElementType and finally lets retrieve these as elements by using the ToElements method. Great, so we have now collected all the elements in the active view that we want to tag. Let's look through each of these in the using statement to tag each one at a time. So between the Start and Commit methods, let's create a foreach loop, for each element in the tElements list. We'll use the variable ele in tElements, and for each element in the list that we want to tag, we're going to need a reference to that element and a location, we can create a reference using the reference class constructor. This takes an element, so let's do that by creating a reference variable named refe, and we'll assign to that a new reference with ele as the parameter, and for the location let's get the location point from the element using the variable loc. So LocationPoint, and we'll retrieve this by accessing the location property from the element as a LocationPoint, and from this LocationPoint let's retrieve the XYZ which we'll call point by accessing the Point property from loc. Perfect, we now have all of the ingredients to create a tag using the create method from the independent tag class. So let's create an IndependentTag variable named tag and we'll assign to this a call to the create method from the IndependantTag class, for the variables let's use the document doc, next we need the view to tag in, so let's use the ActiveView from the document. We'll then need the reference to the element, in our case this will be refe, then true to add a leader. Tmode for our tag mode, then we need our tag orientation which will be tOrient and finally the location for the tag which will be point in our case. Awesome, so this command will collect all the doors and windows in an active view and tag them one at a time. Let's go head and try this out, I've already added the command into the manifest file, so go head and hit Start to debug, then open up the exercise file for this video, and in here you can see that I've added a couple of doors to the project file. So let's go ahead, and run our command which is TagView. Perfect it looks like all the windows and doors have been tagged in the view. This can be a very powerful tool to automate tagging of certain elements, if you want to take this further, try looking through a series of views and tagging all elements rather than just one view.