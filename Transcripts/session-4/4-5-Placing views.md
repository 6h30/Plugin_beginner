kịch bản video hướng dẫn từng bước — trình bày dạng video tutorial có thoại, từng bước rõ ràng, kết hợp phần hình ảnh minh họa , với nội dung sau: 
4-5-
Placing views
Selecting transcript lines in this section will navigate to timestamp in the video
- [Instructor] In this section, we've learned how to create views, annotate them and create sheets. The last step is to learn how to place a view onto a sheet. Views are displayed on sheets via the viewport object. The viewport class is different to other views that we've looked at in that it is not actually a view. It inherits from the element class and is simply used to place views onto sheets. This can be done by using the create method within the class. This will create a new viewport at a given location. The parameters it requires is the document the view sheet ID that the view is to be placed on, the view ID for the view to be shown and an XYZ object for its location and once we have created the viewport, we can access the properties and methods that relate to the viewport object. So, using this method in a new command, let's try and place the viewport at the center of a sheet. I've currently got the Visual Studio exercise file open for this video. In here I've created a PlaceView class which is a new IExternalCommand. In here I've retrieved the document and then I've set up two filtered element collectors, one to retrieve the sheet that we created in an earlier video and the other to retrieve the view that we created in an earlier video. I've then set up an transaction which we can use to create the viewport. The first thing we need to do is get the center of the sheet. To do that we can retrieve the outline of the sheet by accessing its outline property. This will return a BoundingBoxUV object. This object is essentially a bounding 2D rectangle around an object, the sheet in our case. The rectangle is defined by U and V directions. Where these interact, we can define U, V parameters. Think of these like X, Y coordinates on a 2D plane. So, by getting this outline, we can get the max U, V coordinate and the min U, V coordinate. These can be accessed by two properties on the outline object. And from this we can determine the midpoint between these two coordinates. This is done with the formula max U value plus the min U value divided by two which will create the X value for an XYZ coordinate and then we can add the max V value plus the min V value divided by two which will create the Y coordinate of the midpoint. We can then use this midpoint to place our view. So, let's start by retrieving the BoundingBoxUV object. To do this, let's create a BoundingBoxUV variable and we'll name it outline. Then we'll assign to this the bounding box by accessing the outline property from the sheet we've collected. So, vSheet.Outline. We can now access the max and min U, V coordinates. So, let's use these to create the X and Y variables that will drive our XYZ object. To do that, let's start by getting the X coordinate by creating a double variable named x and we'll assign to this a call to the max U, V value by accessing outline.Max.U and then adding to this the outline.Min.U value and dividing the result by two. Perfect. Next, let's do the same for the Y value by creating a double variable named Y and assigning to this the outline.Max.V value plus the outline.Min.U value and dividing that result by two. Great. We now have the X and Y variables. We can use these to create a new XYZ object. So, let's do that and we'll call it midPoint which will be a new XYZ using the x variable and the y variable for the x and y parameters and zero for z. Perfect, so now that we have a location to place the viewport, let's do so within the transaction. To do this, let's create a viewport variable named viewport and we'll assign to this a call to the create method from the viewport class which will take the sheet that was retrieved, so vSheet.Id, then the view to be placed, in this case it's vPlan.Id and then our midPoint. Great, so we've retrieved the midpoint of the sheet and used this to create a viewport at that location. Let's give this command a try. I've already gone ahead and added this command into the manifest file. So, let's hit Start to debug the command. And you can see that we get an error which is the x variable cannot be used and that's because it's being used in these lambda expressions, so let's change this to xu and yu. Great, then go ahead and hit Start. Then open up the Revit exercise file for this video. In this file we have the sheet that we created in the last video and in the View section, we have the floor plan that was also created in an earlier video. So, let's run our new command which is called PlaceView. Perfect, so you can see that we've placed the viewport at the center of the sheet as planned. Having the ability to access sheets and place views through the Revit API offers a huge potential for automating tasks. One thing to note though is to make sure the view is eligible to be placed before doing so as some views such as schedules cannot be placed with the viewport class. The best way to do that is use the canAddViewToSheet method from the viewport class.