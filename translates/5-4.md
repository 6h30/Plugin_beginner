5-4- Thêm biểu tượng

[Giảng viên] Với thanh ribbon tùy chỉnh trong giao diện người dùng Revit, chúng ta có thể thêm bao nhiêu lệnh tùy thích và tùy chỉnh chúng theo nhiều cách khác nhau. Một trong những cách đó là thêm biểu tượng riêng vào các lệnh để giúp chúng dễ nhận biết hơn. Trong video này, chúng ta sẽ cùng tìm hiểu cách thêm biểu tượng vào lệnh mà chúng ta vừa thêm vào tab mới.

Để bắt đầu, chúng ta cần một hình ảnh để sử dụng làm biểu tượng cho nút lệnh. Kích thước lý tưởng cho hình ảnh nút lệnh trong giao diện là 32x32 pixel. Tuy nhiên, một số điều khiển nhỏ hơn như trình đơn thả xuống thì lý tưởng là 16x16 pixel. Như bạn có thể thấy trong thư mục bài tập của video này, tôi đã chuẩn bị sẵn một file .PNG kích thước 32x32 có tên là "desk". Nếu bạn muốn sử dụng một hình ảnh khác, hãy thử tạo nó với kích thước lớn hơn, ví dụ 200x200 pixel trong phần mềm đồ họa vector như Illustrator, sau đó thu nhỏ lại.

Trong ứng dụng bên ngoài nơi chúng ta tạo tab và nút lệnh, hãy thêm đoạn mã để thêm hình ảnh vào nút lệnh. Để làm điều đó, trước tiên chúng ta cần truy cập vào các thuộc tính của nút lệnh. Ở dòng 28, nơi chúng ta thêm nút lệnh, chúng ta cần sửa lại để có thể truy cập nút lệnh sau khi nó được thêm vào. Để làm điều đó, hãy sửa dòng này và thêm vào "pushButton", một biến PushButton mới có tên là "pushButton". Bạn có thể thấy phương thức AddItem trả về một RibbonItem. Lớp PushButton kế thừa từ lớp này, vì vậy hãy thử chuyển đổi nó sang kiểu PushButton bằng cách thêm "as PushButton".

Tuyệt vời, bây giờ chúng ta có thể truy cập dữ liệu của PushButton. Thuộc tính "pushButton.LargerImage" cho phép chúng ta lấy và đặt biểu tượng được sử dụng cho nút lệnh đó. Tuy nhiên, chúng ta cần một đối tượng ImageSource, chẳng hạn như BitmapImage, và nó nằm trong assembly PresentationCore. Vì vậy, hãy nhấp chuột phải vào References và chọn Add Reference, sau đó trong tab Assemblies, tìm kiếm "PresentationCore". Chọn nó bằng cách đánh dấu vào hộp kiểm và nhấn OK.

Giờ đây, chúng ta có thể thấy đối tượng ImageSource nằm trong không gian tên System.Windows.Media. Lớp BitmapImage kế thừa từ lớp ImageSource và điều này sẽ cho phép chúng ta tải hình ảnh dưới dạng URI (Uniform Resource Identifier), có thể được sử dụng để định vị hình ảnh của chúng ta. Vì vậy, trước khi tạo PushButton, hãy thêm đoạn mã để truy xuất hình ảnh của chúng ta.

Bắt đầu bằng cách tạo một biến URI có tên là "imagePath", và chúng ta sẽ gán cho nó một URI mới, với tham số là đường dẫn file. Bạn hãy đi đến vị trí lưu hình ảnh, sử dụng CTRL + C để sao chép nó, sau đó CTRL + V để dán vào tham số. Vì nó cần phải là một chuỗi, hãy đặt nó trong dấu ngoặc kép. Sau đó, trước chuỗi, hãy thêm ký hiệu @ để các dấu gạch chéo ngược không bị hiểu là ký tự thoát. Cuối cùng, ở cuối dòng này, hãy thêm "\desk.png".

Bây giờ, sử dụng URI này, chúng ta có thể tạo một đối tượng BitmapImage. Để làm điều đó, hãy tạo một biến BitmapImage có tên là "image". Hiện tại, lớp này chưa được tìm thấy vì chúng ta cần thêm không gian tên vào lớp của mình. Vì vậy, nhấp vào bóng đèn và thêm không gian tên System.Windows.Media.Imaging.

Tuyệt vời, bây giờ nó đã được tham chiếu vào lớp của chúng ta. Tiếp theo, hãy gán cho biến "image" một BitmapImage mới sử dụng "imagePath" làm tham số. Cuối cùng, chúng ta có thể gán BitmapImage này cho thuộc tính LargerImage của nút lệnh. Vì vậy, hãy thêm "= image".

Chúng ta đã thêm hình ảnh vào nút lệnh. Bây giờ hãy nhấn Start để debug. Mở file bài tập Revit cho video này, sau đó đi đến tab mới của chúng ta. Hoàn hảo, bạn có thể thấy rằng lệnh của chúng ta bây giờ đã có biểu tượng riêng. Như bạn có thể tưởng tượng, điều này giúp hiển thị các lệnh của chúng ta dễ dàng và sinh động hơn rất nhiều. Ngoài ra, còn có nhiều cách khác nhau để hiển thị nút lệnh, chẳng hạn như trình đơn thả xuống, nút radio hoặc hộp danh sách nút lệnh. Nếu bạn muốn tìm hiểu thêm về những điều này, hãy thử xem Hướng dẫn Giao diện được hiển thị trong trang Hướng dẫn dành cho Nhà phát triển Revit.